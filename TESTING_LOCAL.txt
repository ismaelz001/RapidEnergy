â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                                                                                â•‘
â•‘                  âœ… TESTING OCR CONFIGURADO - LISTO PARA LOCAL                 â•‘
â•‘                                                                                â•‘
â•‘              (Toda la documentaciÃ³n fue eliminada para mantener limpia)        â•‘
â•‘              (la repo - Solo quedan scripts de testing funcionales)            â•‘
â•‘                                                                                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•


ğŸ“¦ ARCHIVOS FINALES (Listos para Usar)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ§ª SCRIPTS DE TESTING:
  âœ… test.py                   - Test simple (RECOMENDADO)
  âœ… test_ocr_directo.py       - Test directo sin servidor
  âœ… test_ocr_upload.py        - Test del endpoint HTTP
  âœ… analizar_facturas.py      - AnÃ¡lisis estÃ¡tico para debugging

ğŸ“– DOCUMENTACIÃ“N MÃNIMA:
  âœ… TEST.md                   - Instrucciones para ejecutar


ğŸ—‘ï¸  ARCHIVOS ELIMINADOS (Para mantener limpia la repo):
  âŒ README_TESTING.md
  âŒ TEST_OCR_RESUMEN.md
  âŒ RESUMEN.md
  âŒ INDEX.md
  âŒ OCR_TEST_GUIDE.md
  âŒ EJEMPLO_SALIDA_TESTS.md
  âŒ RECOMENDACIONES_TESTING.md
  âŒ RESUMEN_EJECUTIVO.md
  âŒ TESTING_VISUAL.txt
  âŒ COMPLETADO.txt
  âŒ INICIO_AQUI.txt
  âŒ test_ocr_upload.js
  âŒ test_ocr_powershell.ps1
  âŒ run_test.bat


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ ESTRUCTURA FINAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

F:\MecaEnergy\
â”œâ”€â”€ ğŸ§ª test.py                    â† EJECUTAR ESTO PRIMERO
â”œâ”€â”€ test_ocr_directo.py
â”œâ”€â”€ test_ocr_upload.py
â”œâ”€â”€ analizar_facturas.py
â”œâ”€â”€ TEST.md                       â† LEER ESTO PRIMERO
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ ocr.py                â† CÃ³digo a testear
â”‚   â””â”€â”€ routes/
â”‚       â””â”€â”€ webhook.py
â”‚
â”œâ”€â”€ temp_facturas/                â† PDFs para testear
â”‚   â”œâ”€â”€ Factura Iberdrola.pdf
â”‚   â”œâ”€â”€ factura Naturgy.pdf
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ requirements.txt              â† Dependencias

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš¡ PASOS PARA TESTEAR EN LOCAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PASO 1: Instalar dependencias
   â””â”€ pip install -r requirements.txt

PASO 2: Ejecutar test
   â””â”€ python test.py
   
   O si quieres un PDF especÃ­fico:
   â””â”€ python test.py temp_facturas/"Factura Iberdrola.pdf"

PASO 3: Ver resultado
   â””â”€ Si ves âœ… en todos los campos â†’ OCR FUNCIONA
   â””â”€ Si ves âŒ o âš ï¸  â†’ Necesita ajustes

PASO 4: Si hay problemas
   â””â”€ python analizar_facturas.py  (ve quÃ© hay en los PDFs)
   â””â”€ Edita app/services/ocr.py    (ajusta regex)
   â””â”€ Vuelve al PASO 2             (retest)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… OBJETIVO: Test Local
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Arquitectura:
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ LOCAL (Tu mÃ¡quina - Windows)                            â”‚
  â”‚ â”œâ”€ Python + FastAPI (app/main.py)                       â”‚
  â”‚ â”œâ”€ OCR (app/services/ocr.py)                            â”‚
  â”‚ â”œâ”€ Tests (test.py, test_ocr_directo.py, etc.)          â”‚
  â”‚ â””â”€ Facturas PDF (temp_facturas/)                        â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“ (si todo funciona)
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ PRODUCCIÃ“N (Vercel + Render + Neon)                     â”‚
  â”‚ â”œâ”€ Next.js en Vercel (frontend)                         â”‚
  â”‚ â”œâ”€ FastAPI en Render (backend)                          â”‚
  â”‚ â””â”€ PostgreSQL en Neon (base de datos)                   â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š QUÃ‰ VALIDA CADA TEST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

test.py (RECOMENDADO)
  â”œâ”€ Extrae datos de PDF con OCR
  â”œâ”€ Valida campos crÃ­ticos: CUPS, Total, Consumos, Potencias, Fecha
  â”œâ”€ Detecta valores negativos/absurdos
  â””â”€ 30 segundos de ejecuciÃ³n

test_ocr_directo.py
  â”œâ”€ Test mÃ¡s detallado del OCR
  â”œâ”€ Muestra campos secundarios
  â”œâ”€ Info de debugging
  â””â”€ 1 minuto de ejecuciÃ³n

test_ocr_upload.py
  â”œâ”€ Testa el endpoint /webhook/upload
  â”œâ”€ Requiere servidor corriendo
  â”œâ”€ Test end-to-end
  â””â”€ 1 minuto de ejecuciÃ³n

analizar_facturas.py
  â”œâ”€ Analiza PDFs directamente
  â”œâ”€ Compara datos reales vs extraÃ­dos
  â”œâ”€ Para debugging
  â””â”€ 20 segundos de ejecuciÃ³n

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ RESULTADO ESPERADO (test.py)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰XITO (âœ…):
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CUPS                 | ES0021000000000000001
  âœ… Total                | 350.45
  âœ… Consumo P1           | 120.5
  âœ… Consumo P2           | 245.3
  âœ… Consumo P3           | 89.1
  âœ… Potencia P1          | 3.3
  âœ… Potencia P2          | 3.3
  âœ… PerÃ­odo              | 30
  âœ… Fecha                | 2026-01-15

  âœ… ExtraÃ­dos: 9/9
  âŒ Problemas: 0/9
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  ğŸ‰ OCR FUNCIONA CORRECTAMENTE

CON PROBLEMAS (âš ï¸):
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  âœ… CUPS                 | ES0021000000000000001
  âœ… Total                | 350.45
  âŒ Consumo P1           | No extraÃ­do
  âœ… Consumo P2           | 245.3
  âš ï¸  Consumo P3           | -15.3 (invÃ¡lido)
  ...

  âœ… ExtraÃ­dos: 6/9
  âŒ Problemas: 3/9
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  âš ï¸  OCR REQUIERE AJUSTES
  Ejecuta: python analizar_facturas.py

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ SI ENCUENTRAS PROBLEMAS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Problema: "Error al importar OCR"
SoluciÃ³n:
  1. pip install -r requirements.txt
  2. Verifica que estÃ¡s en F:\MecaEnergy
  3. Verifica Python 3.9+: python --version

Problema: "Archivo no existe"
SoluciÃ³n:
  1. Verifica que hay PDFs en temp_facturas/
  2. O especifica ruta: python test.py <archivo>

Problema: "Campo X no se extrae"
SoluciÃ³n:
  1. Ejecuta: python analizar_facturas.py
  2. Ve si el dato estÃ¡ en el PDF
  3. Si estÃ¡ â†’ edita app/services/ocr.py
  4. Si no â†’ problema con el PDF

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ ARCHIVOS IMPORTANTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Para ejecutar tests:
  â†’ test.py (simple)
  â†’ test_ocr_directo.py (detallado)

Para debuggear:
  â†’ analizar_facturas.py (analiza PDFs)
  â†’ app/services/ocr.py (edita regex si falla)

Para configurar local:
  â†’ requirements.txt (instala dependencias)
  â†’ TEST.md (instrucciones)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ PRÃ“XIMOS PASOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. INSTALAR DEPENDENCIAS (1 minuto)
   â””â”€ pip install -r requirements.txt

2. TESTEAR OCR LOCAL (30 segundos)
   â””â”€ python test.py
   
3. Â¿TODO OK?
   â”œâ”€ SÃ â†’ Ir al paso 4
   â””â”€ NO â†’ Ejecuta python analizar_facturas.py, edita ocr.py, retest

4. VALIDAR CON MÃšLTIPLES FACTURAS (5 minutos)
   â””â”€ Prueba con Iberdrola, Naturgy, etc.

5. SUBIR A PRODUCCIÃ“N (en Git)
   â””â”€ Una vez que todo funciona en local:
      git add .
      git commit -m "OCR validado en local"
      git push
      
      Las plataformas (Render, Vercel, Neon) desplegarÃ¡n automÃ¡ticamente

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ RESUMEN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Estado: âœ… LISTO PARA TESTEAR EN LOCAL

QuÃ© tienes:
  âœ… 4 Scripts de testing
  âœ… DocumentaciÃ³n mÃ­nima (TEST.md)
  âœ… Repo limpia (sin documentaciÃ³n de testing)

QuÃ© hace falta:
  â³ Python instalado + pip install -r requirements.txt
  â³ Ejecutar tests
  â³ Si todo OK, subir a producciÃ³n

Tiempo estimado:
  â±ï¸  Setup (instalar deps): 5 minutos
  â±ï¸  Test rÃ¡pido: 30 segundos
  â±ï¸  Debugging (si necesario): 30 minutos
  â±ï¸  Validar mÃºltiples: 10 minutos

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    ğŸš€ EMPIEZA CON:
                       pip install -r requirements.txt
                       python test.py

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
